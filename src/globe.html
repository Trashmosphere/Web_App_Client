<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">  
<!-- Include the CesiumJS JavaScript and CSS files -->
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.86/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.86/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style src="./css/globe.css"></style>
</head>

<body>
  <div id="canvas-container">
    <div id="cesiumContainer"></div>
    
    <div class="dropdown" style="position:absolute; left:5%; top:5%;">
      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <span class="icon1"></span>>
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#">Action</a>
        <a class="dropdown-item" href="#">Another action</a>
        <a class="dropdown-item" href="#">Something else here</a>
      </div>
    </div>

    <div class="btn-group dropup" style="position:absolute; left:5%; top:80%">
      <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Dropup
      </button>
      <div class="dropdown-menu">
        <!-- Dropdown menu links -->
      </div>
    </div>
    
    
  </div>
  <script>
    // Your access token can be found at: https://cesium.com/ion/tokens.
    // Replace `your_access_token` with your Cesium ion access token.

    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3MmJkYmFiMy0zNTIxLTRhMTctOGZkZC1jYTc1MmFmNzFhZTIiLCJpZCI6NjkxMDMsImlhdCI6MTYzMzE2NzA2Nn0.qB8RlADfiOvH4pspmgRhNSnCzpk0MwpO5HBVZYOggog';

    // Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
    const viewer = new Cesium.Viewer('cesiumContainer', {
      terrainProvider: Cesium.createWorldTerrain()
    });

    let isPossible=false;
    let lastX=0, difX=0;
    let lastY=0, difY=0;

    setInterval(()=>{
      isPossible=true;
    },10);

    if (window.DeviceOrientationEvent) {
      window.addEventListener('deviceorientation', (evt) => {
        if (lastX==0 && lastY==0)
        {
          lastX=-evt.alpha;
          lastY=-evt.gamma;
        }
        if (isPossible===true)
        {
        //Punem -beta pentru ca daca telefonul merge in stanga, alpha creste
        if (Math.abs(-evt.alpha-lastX)>10){
          difX=0;
          lastX=-evt.alpha;
        }
        else{
        difX=-evt.alpha-lastX;
      lastX=lastX+difX}

        //Punem -gamma, pentru ca gamma scade cand telefonul se orienteazaa in sus
        if(Math.abs(-evt.gamma-lastY)>10){
          difY=0;
          lastY=-evt.gamma;
        }
        else{
        difY=-evt.gamma-lastY;
        lastY=lastY+difY;
        }
        if (difX>0)
        {
          viewer.camera.lookRight(Cesium.Math.toRadians(difX));
        }
        else{
          viewer.camera.lookLeft(Cesium.Math.toRadians(-difX));
        }
        if(difY>0)
        {
          viewer.camera.lookUp(Cesium.Math.toRadians(difY));
        }
        else{
          viewer.camera.lookDown(Cesium.Math.toRadians(-difY));
        }
    

        isPossible=false;
      }
      }, false);
    }

    viewer.dataSources.add(
      Cesium.CzmlDataSource.load("getCZML")
    );
    // Fly the camera to San Francisco at the given longitude, latitude, and height.
    viewer.camera.setView({
      destination: Cesium.Cartesian3.fromDegrees(23.5736303, 46.751339, 800),
      orientation: {
        heading: Cesium.Math.toRadians(0.0),
        pitch: Cesium.Math.toRadians(0.0),
      }
    });
  </script>
  </div>
</body>

</html>